name: Daily Job

on:
  schedule:
    - cron: '0 2 * * *'  # Runs at 8am IST daily (UTC 2:00 AM)
    - cron: '30 13 * * *' # Runs at 7pm IST daily (UTC 1:30 PM)
  push:
    branches:
      - main  # Runs when pushing to the main branch

jobs:
  run-daily:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@main  # Use the correct version for checkout

      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y wget unzip google-chrome-stable
          # Install matching ChromeDriver
          CHROME_VERSION=$(google-chrome --version | awk '{print $3}' | cut -d'.' -f1)
          DRIVER_VERSION=$(curl -s "https://chromedriver.storage.googleapis.com/LATEST_RELEASE_${CHROME_VERSION}")
          wget -N "https://chromedriver.storage.googleapis.com/$DRIVER_VERSION/chromedriver_linux64.zip" -P drivers/
          unzip -o drivers/chromedriver_linux64.zip -d drivers/
          chmod +x drivers/chromedriver

      - name: Run tests with @Naukri tag
        run: mvn test -Dcucumber.options="--tags @Naukri"
